<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>界面信息</title>
<script type="text/javascript" language="javascript"
	src="${def:context}/js/jquery/jquery.colorpicker.js"></script>
</head>
<body>
	<!-- 页眉 -->
	<div class="panel panel-default col_mainInner">
		<div
			class="panel-heading col_main_body_title text-center col-xs-12 col-sm-12 col-md-12 col-lg-12">
			<div class="col-xs-9 col-sm-9 col-md-9 col-lg-9 ">
				<h1 class="panel-title">字段配置</h1>
			</div>
			<div class="col-xs-3 col-sm-3 col-md-2 col-lg-2 " style="margin-top:-12px;">
					<button type="button"
						class="btn btn-primary btn-md btn_permissions">权限配置</button>
					<button type="button" id="publishBtn"
						class="btn btn-primary btn-md">保存</button>
			</div>
		</div>

		<div class="panel-body col_main_body">
			<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
				<!-- 左侧操作面板 -->
				<div class="col-xs-2 col-sm-2 col-md-2 col-lg-2">
					<table class="table table-bordered">
						<tr>
							<th colspan="2" align="center">业务字段</th>
						</tr>
						<tr>
							<th align="center" nowrap>字段名</th>
							<th align="center" nowrap>操作</th>
						</tr>
						<table-field>
						<tr>
							<td title="${fld:field_code}"><input type="hidden"
								name="field_id" id="field_${fld:field_id}"
								value="${fld:field_id}" /> <input type="hidden"
								name="field_name" id="field_name_${fld:field_id}"
								value="${fld:alias}" /> ${fld:alias}</td>
							<td align="center"><img
								src="${def:context}/images/framecontrol/toright.png"
								title="添加该字段" style="cursor: pointer;"
								onclick="javascript:copyField('${fld:field_id}','${fld:alias@html}','${fld:field_code_alias@js}');" />
							</td>
						</tr>
						</table-field>
					</table>
				</div>
				<!-- 中部操作面板 -->
				<div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
					<form class="form-horizontal" role="form" method="post"
						id="formEditor" name="formEditor">
						<input type="hidden" id="form_id" name="form_id"
							value="${fld:form_id}" />
						<div>
							<!-- 标签页 -->
							<ul class="nav nav-tabs">
								<li class="active"><a href="#gridTable"
									onclick="javascript:return selectTable('gridTable');"
									data-toggle="tab">列表</a></li>
								<li><a href="#formTable"
									onclick="javascript:return selectTable('formTable');"
									data-toggle="tab">表单</a></li>
								<li><a href="#filterTable"
									onclick="javascript:return selectTable('filterTable');"
									data-toggle="tab">查询</a></li>
								<li><a href="#excelTable"
									onclick="javascript:return selectTable('excelTable');"
									data-toggle="tab">Excel</a></li>
								<li><a href="#pdfTable"
									onclick="javascript:return selectTable('pdfTable');"
									data-toggle="tab">Pdf</a></li>
							</ul>
							<!-- 标签页对应的表单内容 -->
							<div class="tab-content" style="padding-top: 10px;">
								<!-- 标签页:列表 -->
								<div class="tab-pane active" id="gridTable">
									<table class="table table-condensed">
										<tbody id="gridTableBody">
											<tr>
												<th colspan="4" align="center">列表字段</th>
											</tr>
											<tr>
												<th align="center" nowrap>操作</th>
												<th align="center" nowrap>顺序</th>
												<th align="center" nowrap>字段名</th>
												<th align="center" nowrap>操作</th>
											</tr>
											<grid-field>
											<tr dragFlag="true"
												onclick="javascript:showProperty('${fld:field_id}')"
												title="${fld:field_code_alias}">
												<td align="center"><img
													src="${def:context}/images/framecontrol/toleft.png"
													title="移除该字段" style="cursor: pointer;"
													onclick="javascript:removeField(this);" /></td>
												<td align="center"><input type="hidden"
													name="grid_field" id="grid_field_${fld:field_id}"
													value="${fld:field_id}" /> <input type="hidden"
													name="grid_field_name" id="grid_field_name_${fld:field_id}"
													value="${fld:alias}" /> <input type="text"
													name="grid_show_order" id="grid_show_order_${fld:field_id}"
													size="2" value="${fld:show_order}"
													dependent="grid_field_${fld:field_id}" /> <input
													type="hidden" name="grid_sort_order"
													id="grid_sort_order_${fld:field_id}"
													value="${fld:sort_order}"
													dependent="grid_field_${fld:field_id}" /> <input
													type="hidden" name="grid_show_flag"
													id="grid_show_flag_${fld:field_id}"
													value="${fld:show_flag}"
													dependent="grid_field_${fld:field_id}" /> <input
													type="hidden" name="grid_format"
													id="grid_format_${fld:field_id}" value="${fld:format}"
													dependent="grid_field_${fld:field_id}" /> <input
													type="hidden" name="grid_print_html"
													id="grid_print_html_${fld:field_id}"
													value="${fld:print_html}"
													dependent="grid_field_${fld:field_id}" /> <input
													type="hidden" name="grid_compute_total"
													id="grid_compute_total_${fld:field_id}"
													value="${fld:compute_total}"
													dependent="grid_field_${fld:field_id}" /> <input
													type="hidden" name="grid_show_align"
													id="grid_show_align_${fld:field_id}"
													value="${fld:show_align}"
													dependent="grid_field_${fld:field_id}" /></td>
												<td align="center">${fld:alias}</td>
												<td align="center"><img
													src="${def:context}/images/framecontrol/tofull.png"
													title="查看字段属性" style="cursor: pointer;"
													onclick="javascript:showProperty('${fld:field_id}')" /></td>
											</tr>
											</grid-field>
										</tbody>
									</table>
								</div>
								<!-- 标签页：表单 -->
								<div class="tab-pane" id="formTable">
									<table class="table table-condensed">
										<tbody id="formTableBody">
											<tr>
												<th colspan="4" align="center">表单字段</th>
											</tr>
											<tr>
												<th align="center" nowrap>操作</th>
												<th align="center" nowrap>顺序</th>
												<th align="center" nowrap>字段名</th>
												<th align="center" nowrap>操作</th>
											</tr>
											<form-field>
											<tr dragFlag="true"
												onclick="javascript:showProperty('${fld:field_id}')"
												title="${fld:field_code_alias}">
												<td align="center"><img
													src="${def:context}/images/framecontrol/toleft.png"
													title="移除该字段" style="cursor: pointer;"
													onclick="javascript:removeField(this);" /></td>
												<td align="center"><input type="hidden"
													name="form_field" id="form_field_${fld:field_id}"
													value="${fld:field_id}" /> <input type="hidden"
													name="form_field_name" id="form_field_name_${fld:field_id}"
													value="${fld:alias}" /> <input type="hidden"
													name="form_show_type" id="form_show_type_${fld:field_id}"
													value="${fld:show_type}"
													dependent="form_field_${fld:field_id}" /> <input
													type="hidden" name="form_is_mandatory"
													id="form_is_mandatory_${fld:field_id}"
													value="${fld:is_mandatory}"
													dependent="form_field_${fld:field_id}" /> <input
													type="hidden" name="form_is_readonly"
													id="form_is_readonly_${fld:field_id}"
													value="${fld:is_readonly}"
													dependent="form_field_${fld:field_id}" /> <input
													type="hidden" name="form_item_id"
													id="form_item_id_${fld:field_id}" value="${fld:item_id}"
													dependent="form_field_${fld:field_id}" /> <input
													type="hidden" name="form_show_color"
													id="form_show_color_${fld:field_id}"
													value="${fld:show_color}"
													dependent="form_field_${fld:field_id}" /> <input
													type="hidden" name="form_width"
													id="form_width_${fld:field_id}" value="${fld:width}"
													dependent="form_field_${fld:field_id}" /> <input
													type="hidden" name="form_colspan"
													id="form_colspan_${fld:field_id}" value="${fld:colspan}"
													dependent="form_field_${fld:field_id}" /> <input
													type="hidden" name="form_rowspan"
													id="form_rowspan_${fld:field_id}" value="${fld:rowspan}"
													dependent="form_field_${fld:field_id}" /> <input
													type="hidden" name="form_is_cascade_combo"
													id="form_is_cascade_combo_${fld:field_id}"
													value="${fld:is_cascade_combo}"
													dependent="form_field_${fld:field_id}" /> <input
													type="text" size="2" name="form_show_order"
													id="form_show_order_${fld:field_id}"
													value="${fld:show_order}"
													dependent="form_field_${fld:field_id}" /></td>
												<td align="center">${fld:alias}</td>
												<td align="center"><img
													src="${def:context}/images/framecontrol/tofull.png"
													title="查看字段属性" style="cursor: pointer;"
													onclick="javascript:showProperty('${fld:field_id}')" /></td>
											</tr>
											</form-field>
										</tbody>
									</table>
								</div>
								<!-- 标签页：查询 -->
								<div class="tab-pane" id="filterTable">
									<table class="table table-condensed">
										<tbody id="filterTableBody">
											<tr>
												<th colspan="4" align="center">查询条件字段</th>
											</tr>
											<tr>
												<th align="center" nowrap>操作</th>
												<th align="center" nowrap>顺序</th>
												<th align="center" nowrap>字段名</th>
												<th align="center" nowrap>操作</th>
											</tr>
											<filter-field>
											<tr dragFlag="true"
												onclick="javascript:showProperty('${fld:field_id}')"
												title="${fld:field_code_alias}">
												<td align="center"><img
													src="${def:context}/images/framecontrol/toleft.png"
													title="移除该字段" style="cursor: pointer;"
													onclick="javascript:removeField(this);" /></td>
												<td align="center"><input type="hidden"
													name="filter_field" id="filter_field_${fld:field_id}"
													value="${fld:field_id}" /> <input type="hidden"
													name="filter_field_name"
													id="filter_field_name_${fld:field_id}" value="${fld:alias}" />
													<input type="hidden" name="filter_show_type"
													id="filter_show_type_${fld:field_id}"
													value="${fld:show_type}"
													dependent="filter_field_${fld:field_id}" /> <input
													type="hidden" name="filter_is_mandatory"
													id="filter_is_mandatory_${fld:field_id}"
													value="${fld:is_mandatory}"
													dependent="filter_field_${fld:field_id}" /> <input
													type="hidden" name="filter_item_id"
													id="filter_item_id_${fld:field_id}" value="${fld:item_id}"
													dependent="filter_field_${fld:field_id}" /> <input
													type="hidden" name="filter_width"
													id="filter_width_${fld:field_id}" value="${fld:width}"
													dependent="filter_field_${fld:field_id}" /> <input
													type="hidden" name="filter_colspan"
													id="filter_colspan_${fld:field_id}" value="${fld:colspan}"
													dependent="filter_field_${fld:field_id}" /> <input
													type="hidden" name="filter_rowspan"
													id="filter_rowspan_${fld:field_id}" value="${fld:rowspan}"
													dependent="filter_field_${fld:field_id}" /> <input
													type="hidden" name="filter_filter_type"
													id="filter_filter_type_${fld:field_id}"
													value="${fld:filter_type}"
													dependent="filter_field_${fld:field_id}" /> <input
													type="text" size="2" name="filter_show_order"
													id="filter_show_order_${fld:field_id}"
													value="${fld:show_order}"
													dependent="filter_field_${fld:field_id}" /></td>
												<td align="center">${fld:alias}</td>
												<td align="center"><img
													src="${def:context}/images/framecontrol/tofull.png"
													title="查看字段属性" style="cursor: pointer;"
													onclick="javascript:showProperty('${fld:field_id}')" /></td>
											</tr>
											</filter-field>
										</tbody>
									</table>
								</div>
								<!-- 标签页：Excel -->
								<div class="tab-pane" id="excelTable">
									<table class="table table-condensed">
										<tbody id="excelTableBody">
											<tr>
												<th colspan="4" align="center">Excel导出字段</th>
											</tr>
											<tr>
												<th align="center" nowrap>操作</th>
												<th align="center" nowrap>顺序</th>
												<th align="center" nowrap>字段名</th>
												<th align="center" nowrap>操作</th>
											</tr>
											<excel-field>
											<tr dragFlag="true"
												onclick="javascript:showProperty('${fld:field_id}')"
												title="${fld:field_code_alias}">
												<td align="center"><img
													src="${def:context}/images/framecontrol/toleft.png"
													title="移除该字段" style="cursor: pointer;"
													onclick="javascript:removeField(this);" /></td>
												<td align="center"><input type="hidden"
													name="excel_field" id="excel_field_${fld:field_id}"
													value="${fld:field_id}" /> <input type="hidden"
													name="excel_field_name"
													id="excel_field_name_${fld:field_id}" value="${fld:alias}" />
													<input type="hidden" name="excel_show_type"
													id="excel_show_type_${fld:field_id}"
													value="${fld:show_type}"
													dependent="excel_field_${fld:field_id}" /> <input
													type="hidden" name="excel_width"
													id="excel_width_${fld:field_id}" value="${fld:width}"
													dependent="excel_field_${fld:field_id}" /> <input
													type="text" size="2" name="excel_show_order"
													id="excel_show_order_${fld:field_id}"
													value="${fld:show_order}"
													dependent="excel_field_${fld:field_id}" /></td>
												<td align="center">${fld:alias}</td>
												<td align="center"><img
													src="${def:context}/images/framecontrol/tofull.png"
													title="查看字段属性" style="cursor: pointer;"
													onclick="javascript:showProperty('${fld:field_id}')" /></td>
											</tr>
											</excel-field>
										</tbody>
									</table>
								</div>
								<!-- 标签页：Pdf -->
								<div class="tab-pane" id="pdfTable">
									<table class="table table-condensed">
										<tbody id="pdfTableBody">
											<tr>
												<th colspan="4" align="center">Pdf导出字段</th>
											</tr>
											<tr>
												<th align="center" nowrap>操作</th>
												<th align="center" nowrap>顺序</th>
												<th align="center" nowrap>字段名</th>
												<th align="center" nowrap>操作</th>
											</tr>
											<pdf-field>
											<tr dragFlag="true"
												onclick="javascript:showProperty('${fld:field_id}')"
												title="${fld:field_code_alias}">
												<td align="center"><img
													src="${def:context}/images/framecontrol/toleft.png"
													title="移除该字段" style="cursor: pointer;"
													onclick="javascript:removeField(this);" /></td>
												<td align="center"><input type="hidden"
													name="pdf_field" id="pdf_field_${fld:field_id}"
													value="${fld:field_id}" /> <input type="hidden"
													name="pdf_field_name" id="pdf_field_name_${fld:field_id}"
													value="${fld:alias}" /> <input type="hidden"
													name="pdf_show_type" id="pdf_show_type_${fld:field_id}"
													value="${fld:show_type}"
													dependent="pdf_field_${fld:field_id}" /> <input
													type="hidden" name="pdf_width"
													id="pdf_width_${fld:field_id}" value="${fld:width}"
													dependent="pdf_field_${fld:field_id}" /> <input
													type="hidden" name="pdf_format"
													id="pdf_format_${fld:field_id}" value="${fld:format}"
													dependent="pdf_field_${fld:field_id}" /> <input
													type="text" size="2" name="pdf_show_order"
													id="pdf_show_order_${fld:field_id}"
													value="${fld:show_order}"
													dependent="pdf_field_${fld:field_id}" /></td>
												<td align="center">${fld:alias}</td>
												<td align="center"><img
													src="${def:context}/images/framecontrol/tofull.png"
													title="查看字段属性" style="cursor: pointer;"
													onclick="javascript:showProperty('${fld:field_id}')" /></td>
											</tr>
											</pdf-field>
										</tbody>
									</table>
								</div>
							</div>
						</div>
					</form>
				</div>
				<!-- 右侧:字段属性 -->
				<div class="col-xs-4 col-sm-4 col-md-4 col-lg-4">
					<!-- 列表 -->
					<div id="gridDiv" style="display: none;">
						<form class="form-horizontal" role="form" method="post"
							name="formGrid">
							<table class="table table-condensed">
								<tr>
									<td>字段名称</td>
									<td><input name="grid_field" type="hidden" /> <input
										name="grid_field_name" class="form-control" type="text"
										size="35" value="" readOnly /></td>
								</tr>
								<tr>
									<td>列表是否显示</td>
									<td><select name="grid_show_flag" class="form-control"
										onchange="setProperty()">
											<option value=""></option>
											<option value="1">是</option>
											<option value="0">否</option>
									</select></td>
								</tr>
								<tr>
									<td>列表输出HTML</td>
									<td><select name="grid_print_html" class="form-control"
										onchange="setProperty()">
											<option value=""></option>
											<option value="1">是</option>
											<option value="0">否</option>
									</select></td>
								</tr>
								<tr>
									<td>加总计算</td>
									<td><select name="grid_compute_total" class="form-control"
										onchange="setProperty()">
											<option value=""></option>
											<option value="1">是</option>
											<option value="0">否</option>
									</select></td>
								</tr>
								<tr>
									<td>列表排列顺序</td>
									<td><select name="grid_sort_order" class="form-control"
										onchange="setProperty()">
											<option value=""></option>
											<option value="0">手工</option>
											<option value="asc">升序</option>
											<option value="desc">降序</option>
									</select></td>
								</tr>
								<tr>
									<td>列表水平对齐</td>
									<td><select name="grid_show_align" class="form-control"
										onchange="setProperty()">
											<option value=""></option>
											<option value="center">居中</option>
											<option value="left">左对齐</option>
											<option value="right">右对齐</option>
									</select></td>
								</tr>
								<tr>
									<td>列表显示格式</td>
									<td><input name="grid_format" type="text"
										class="form-control" size="35" value=""
										onchange="setProperty()" /></td>
								</tr>
								<tr>
									<td>列表显示顺序</td>
									<td><input name="grid_show_order_sigle"
										class="form-control" type="text" size="35" value=""
										onchange="setProperty()" /></td>
								</tr>
							</table>
							<table class="table table-condensed">
								<tr>
									<td align="center" colspan="1">
										<button type="button" onclick="hiddenEditDiv()"
											class="btn btn-primary btn-md">关闭</button>
									</td>
								</tr>
							</table>
						</form>
					</div>
					<!-- 表单 -->
					<div id="formDiv" style="display: none;">
						<form class="form-horizontal" role="form" method="post"
							name="formForm">
							<table class="table table-condensed">
								<tr>
									<td>字段名称</td>
									<td><input name="form_field" type="hidden" /> <input
										name="form_field_name" class="form-control" type="text"
										size="35" value="" readOnly /></td>
								</tr>
								<tr>
									<td>显示分类</td>
									<td><select name="form_item_id" class="form-control"
										onchange="setProperty()">
											<option value="">默认</option>
											<show-item>
											<option value="${fld:item_id}">${fld:item_name}</option>
											</show-item>
									</select></td>
								</tr>
								<tr>
									<td>显示类型</td>
									<td><select name="form_show_type" class="form-control"
										onchange="setProperty()">
											<option value="">默认</option>
											<option value="0">文本框</option>
											<option value="1">下拉框</option>
											<option value="2">复选框</option>
											<option value="3">多选一</option>
											<option value="4">只读</option>
											<option value="5">日期</option>
											<option value="6">文本域</option>
											<option value="7">选取框(外键关联)</option>
											<option value="9">HIDDEN</option>
											<option value="10">日期时间</option>
											<option value="11">仅显示</option>
									</select></td>
								</tr>
								<tr>
									<td>是否非空</td>
									<td><select name="form_is_mandatory" class="form-control"
										onchange="setProperty()">
											<option value="1">可以为空</option>
											<option value="0">非空</option>
									</select></td>
								</tr>
								<tr>
									<td>是否只读</td>
									<td><select name="form_is_readonly" class="form-control"
										onchange="setProperty()">
											<option value="0">非只读</option>
											<option value="1">只读</option>
									</select></td>
								</tr>
								<tr>
									<td>是否级联字段</td>
									<td><select name="form_is_cascade_combo"
										class="form-control" onchange="setProperty()">
											<option value="0">非级联</option>
											<option value="1">级联</option>
									</select></td>
								</tr>
								<tr>
									<td>宽度</td>
									<td><input name="form_width" class="form-control"
										type="text" size="35" value="" onchange="setProperty()" /></td>
								</tr>
								<tr>
									<td>列数</td>
									<td><input name="form_colspan" class="form-control"
										type="text" size="35" value="" onchange="setProperty()" /></td>
								</tr>
								<tr>
									<td>行数</td>
									<td><input name="form_rowspan" class="form-control"
										type="text" size="35" value="" onchange="setProperty()" /></td>
								</tr>
								<tr>
									<td>显示顺序</td>
									<td><input name="form_show_order" class="form-control"
										type="text" size="35" value="" onchange="setProperty()" /></td>
								</tr>
								<tr>
									<td>背景颜色</td>
									<td>
										<div class="col-xs-6 col-sm-6 col-md-6 col-lg-6"
											style="padding-left: 0">
											<input name="form_show_color" class="form-control"
												id="form_show_color" type="text" size="6" value=""
												onchange="setProperty()" />
										</div>
										<div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
											<img src="${def:context}/images/clear.gif"
												style="cursor: pointer;"
												onclick="javascript:document.formForm.form_show_color.value='';"
												class="tool2" title="清除内容" />
										</div>
									</td>
								</tr>
							</table>
							<table class="table table-condensed">
								<tr>
									<td align="center" colspan="1">
										<button type="button" onclick="hiddenEditDiv()"
											class="btn btn-primary btn-md">关闭</button>
									</td>
								</tr>
							</table>
						</form>
					</div>
					<!-- 查询 -->
					<div id="filterDiv" style="display: none">
						<form class="form-horizontal" role="form" method="post"
							name="formFilter">
							<table class="table table-condensed">
								<tr>
									<td>字段名称</td>
									<td><input name="filter_field" type="hidden" /> <input
										name="filter_field_name" class="form-control" type="text"
										size="35" value="" readOnly /></td>
								</tr>
								<tr>
									<td>显示分类</td>
									<td><select name="filter_item_id" class="form-control"
										onchange="setProperty()">
											<option value="">默认</option>
											<filter-item>
											<option value="${fld:item_id}">${fld:item_name}</option>
											</filter-item>
									</select></td>
								</tr>
								<tr>
									<td>显示类型</td>
									<td><select name="filter_show_type" class="form-control"
										onchange="setProperty()">
											<option value="">默认</option>
											<option value="0">文本框</option>
											<option value="1">下拉框</option>
											<option value="2">复选框</option>
											<option value="3">多选一</option>
											<option value="4">只读</option>
											<option value="5">日期</option>
											<option value="6">文本域</option>
											<option value="7">选取框(外键关联)</option>
											<option value="9">HIDDEN</option>
											<option value="10">日期时间</option>
									</select></td>
								</tr>
								<tr>
									<td>查询条件</td>
									<td><select name="filter_filter_type" class="form-control"
										onchange="setProperty()">
											<option value="=">等于</option>
											<option value="like">包含</option>
											<option value="llike">左包含</option>
											<option value="rlike">右包含</option>
											<option value=">">大于</option>
											<option value=">=">大于等于</option>
											<option value="<">小于</option>
											<option value="<=">小于等于</option>
											<option value="<>">不等于</option>
											<option value="is not null">非空</option>
											<option value="is null">为空</option>
											<option value="in">任意满足</option>
											<option value="not in">任意不满足</option>
									</select></td>
								</tr>
								<tr>
									<td>是否非空</td>
									<td><select name="filter_is_mandatory"
										class="form-control" onchange="setProperty()">
											<option value="1">可以为空</option>
											<option value="0">非空</option>
									</select></td>
								</tr>
								<tr>
									<td>宽度</td>
									<td><input name="filter_width" class="form-control"
										type="text" size="35" value="" onchange="setProperty()" /></td>
								</tr>
								<tr>
									<td>列数</td>
									<td><input name="filter_colspan" class="form-control"
										type="text" size="35" value="" onchange="setProperty()" /></td>
								</tr>
								<tr>
									<td>行数</td>
									<td><input name="filter_rowspan" class="form-control"
										type="text" size="35" value="" onchange="setProperty()" /></td>
								</tr>
								<tr>
									<td>显示顺序</td>
									<td><input name="filter_show_order" class="form-control"
										type="text" size="35" value="" onchange="setProperty()" /></td>
								</tr>
							</table>
							<table class="table table-condensed">
								<tr>
									<td align="center" colspan="1">
										<button type="button" onclick="hiddenEditDiv()"
											class="btn btn-primary btn-md">关闭</button>
									</td>
								</tr>
							</table>
						</form>
					</div>
					<!-- Excel -->
					<div id="excelDiv" style="display: none">
						<form class="form-horizontal" role="form" method="post"
							name="formExcel">
							<table class="table table-condensed">
								<tr>
									<td>字段名称</td>
									<td><input name="excel_field" type="hidden" /> <input
										name="excel_field_name" class="form-control" type="text"
										size="35" value="" readOnly /></td>
								</tr>
								<tr>
									<td>显示类型</td>
									<td><select name="excel_show_type" class="form-control"
										onchange="setProperty()">
											<option value="center">居中</option>
											<option value="left">左对齐</option>
											<option value="right">右对齐</option>
									</select></td>
								</tr>
								<tr>
									<td>导出
									顺序</td>
									<td><input name="excel_show_order" class="form-control"
										type="text" size="35" value="" onchange="setProperty()" /></td>
								</tr>
							</table>
							<table class="table table-condensed">
								<tr>
									<td align="center" colspan="1">
										<button type="button" onclick="hiddenEditDiv()"
											class="btn btn-primary btn-md">关闭</button>
									</td>
								</tr>
							</table>
						</form>
					</div>
					<!-- Pdf -->
					<div id="pdfDiv" style="display: none">
						<form class="form-horizontal" role="form" method="post"
							name="formPdf">
							<table class="table table-condensed">
								<tr>
									<td>字段名称</td>
									<td><input name="pdf_field" type="hidden" /> <input
										name="pdf_field_name" class="form-control" type="text"
										size="35" value="" readOnly /></td>
								</tr>
								<tr>
									<td>显示类型</td>
									<td><select name="pdf_show_type" class="form-control"
										onchange="setProperty()">
											<option value="center">居中</option>
											<option value="left">左对齐</option>
											<option value="right">右对齐</option>
									</select></td>
								</tr>
								<tr>
									<td>宽度</td>
									<td><input name="pdf_width" class="form-control"
										type="text" size="35" value="" onchange="setProperty()" /></td>
								</tr>
								<tr>
									<td>显示格式</td>
									<td><input name="pdf_format" class="form-control"
										type="text" size="35" value="" onchange="setProperty()" /></td>
								</tr>
								<tr>
									<td>导出顺序</td>
									<td><input name="pdf_show_order" class="form-control"
										type="text" size="35" value="" onchange="setProperty()" /></td>
								</tr>
							</table>
							<table class="table table-condensed">
								<tr>
									<td align="center" colspan="1">
										<button type="button" onclick="hiddenEditDiv()"
											class="btn btn-primary btn-md">关闭</button>
									</td>
								</tr>
							</table>
						</form>
					</div>
				</div>
			</div>
		</div>
	</div>


	<!--用于传递当前目录到header模版中-->
	<input type="hidden" name="actionroot" id="actionroot"
		value="${def:actionroot}" />

	<!--indicador de progreso-->
	<div id="status" class="alert"
		style="display: none; color: gray; width: 60%; font-weight: normal; font-family: Arial; margin-top: 10px">
		<img src="${def:context}/images/progress.gif" /> 请稍候...
	</div>

	<script language="javascript">	var removeStr = "<img src='${def:context}/images/framecontrol/toleft.png' title='移除该字段' style='cursor:pointer;' onclick='javascript:removeField(this);'/>";	var detailStr = "<img src='${def:context}/images/framecontrol/tofull.png' title='查看字段属性' style='cursor:pointer;' onclick='javascript:showProperty(\"${field_id}\")'/>";	var gridStr = '<input type="hidden" name="grid_field" id="grid_field_${field_id}" value="${field_id}">'					+	'<input type="hidden" name="grid_field_name" id="grid_field_name_${field_id}" value="${alias}">'					+	'<input type="text" size="2" name="grid_show_order" id="grid_show_order_${field_id}" value="" dependent="grid_field_${field_id}">'					+	'<input type="hidden" name="grid_sort_order" id="grid_sort_order_${field_id}" value="" dependent="grid_field_${field_id}">'					+	'<input type="hidden" name="grid_show_flag" id="grid_show_flag_${field_id}" value="" dependent="grid_field_${field_id}">'					+	'<input type="hidden" name="grid_format" id="grid_format_${field_id}" value="" dependent="grid_field_${field_id}">'					+	'<input type="hidden" name="grid_print_html" id="grid_print_html_${field_id}" value="" dependent="grid_field_${field_id}">'
					+	'<input type="hidden" name="grid_compute_total" id="grid_compute_total_${field_id}" value="" dependent="grid_field_${field_id}">'					+	'<input type="hidden" name="grid_show_align" id="grid_show_align_${field_id}" value="" dependent="grid_field_${field_id}">';
	var formStr = '<input type="hidden" name="form_field" id="form_field_${field_id}" value="${field_id}">'					+	'<input type="hidden" name="form_field_name" id="form_field_name_${field_id}" value="${alias}">'					+	'<input type="hidden" name="form_show_type" id="form_show_type_${field_id}" value="" dependent="form_field_${field_id}">'					+	'<input type="hidden" name="form_is_mandatory" id="form_is_mandatory_${field_id}" value="" dependent="form_field_${field_id}">'					+	'<input type="hidden" name="form_is_readonly" id="form_is_readonly_${field_id}" value="" dependent="form_field_${field_id}">'					+	'<input type="hidden" name="form_item_id" id="form_item_id_${field_id}" value="" dependent="form_field_${field_id}">'					+	'<input type="hidden" name="form_show_color" id="form_show_color_${field_id}" value="" dependent="form_field_${field_id}">'					+	'<input type="hidden" name="form_width" id="form_width_${field_id}" value="" dependent="form_field_${field_id}">'					+	'<input type="hidden" name="form_colspan" id="form_colspan_${field_id}" value="${fld:col_num_edit}" dependent="form_field_${field_id}">'					+	'<input type="hidden" name="form_rowspan" id="form_rowspan_${field_id}" value="1" dependent="form_field_${field_id}">'					+	'<input type="hidden" name="form_is_cascade_combo" id="form_is_cascade_combo_${field_id}" value="" dependent="form_field_${field_id}">'					+	'<input type="text" size="2" name="form_show_order" id="form_show_order_${field_id}" value="" dependent="form_field_${field_id}">';	var filterStr = '<input type="hidden" name="filter_field" id="filter_field_${field_id}" value="${field_id}">'					+	'<input type="hidden" name="filter_field_name" id="filter_field_name_${field_id}" value="${alias}">'					+	'<input type="hidden" name="filter_show_type" id="filter_show_type_${field_id}" value="" dependent="filter_field_${field_id}">'					+	'<input type="hidden" name="filter_is_mandatory" id="filter_is_mandatory_${field_id}" value="" dependent="filter_field_${field_id}">'					+	'<input type="hidden" name="filter_item_id" id="filter_item_id_${field_id}" value="" dependent="filter_field_${field_id}">'					+	'<input type="hidden" name="filter_width" id="filter_width_${field_id}" value="" dependent="filter_field_${field_id}">'					+	'<input type="hidden" name="filter_colspan" id="filter_colspan_${field_id}" value="${fld:col_num_filter}" dependent="filter_field_${field_id}">'					+	'<input type="hidden" name="filter_rowspan" id="filter_rowspan_${field_id}" value="1" dependent="filter_field_${field_id}">'					+	'<input type="hidden" name="filter_filter_type" id="filter_filter_type_${field_id}" value="" dependent="filter_field_${field_id}">'					+	'<input type="text" size="2" name="filter_show_order" id="filter_show_order_${field_id}" value="" dependent="filter_field_${field_id}">';	var excelStr = '<input type="hidden" name="excel_field" id="excel_field_${field_id}" value="${field_id}">'					+	'<input type="hidden" name="excel_field_name" id="excel_field_name_${field_id}" value="${alias}">'					+	'<input type="hidden" name="excel_show_type" id="excel_show_type_${field_id}" value="" dependent="excel_field_${field_id}">'					+	'<input type="hidden" name="excel_width" id="excel_width_${field_id}" value="" dependent="excel_field_${field_id}">'					+	'<input type="text" size="2" name="excel_show_order" id="excel_show_order_${field_id}" value="" dependent="excel_field_${field_id}">';	var pdfStr = '<input type="hidden" name="pdf_field" id="pdf_field_${field_id}" value="${field_id}">'					+	'<input type="hidden" name="pdf_field_name" id="pdf_field_name_${field_id}" value="${alias}">'					+	'<input type="hidden" name="pdf_show_type" id="pdf_show_type_${field_id}" value="" dependent="pdf_field_${field_id}">'					+	'<input type="hidden" name="pdf_width" id="pdf_width_${field_id}" value="" dependent="pdf_field_${field_id}">'					+	'<input type="hidden" name="pdf_format" id="pdf_format_${field_id}" value="" dependent="pdf_field_${field_id}">'					+	'<input type="text" size="2" name="pdf_show_order" id="pdf_show_order_${field_id}" value="" dependent="pdf_field_${field_id}">';	var tables = ["gridTable","formTable","filterTable","excelTable","pdfTable"];	var divs = ["gridDiv","formDiv","filterDiv","excelDiv","pdfDiv"];	var fields = ["grid_field","form_field","filter_field","excel_field","pdf_field"];	var htmlStrs = [gridStr,formStr,filterStr,excelStr,pdfStr];	var nowTable = 0;	function selectTable(table){		for(var i=0;i<tables.length;i++){			if(tables[i] == table){				document.getElementById(tables[i]).style.display = "";				nowTable = i;			}else{				document.getElementById(tables[i]).style.display = "none";			}		}		for(var i=0;i<divs.length;i++){			document.getElementById(divs[i]).style.display = "none";		}	}	function removeField(obj){		//移除tr的onclick事件，防止事件冒泡调用 showProperty		obj.parentNode.parentNode.onclick = function(){};		obj.parentNode.parentNode.parentNode.removeChild(obj.parentNode.parentNode);		for(var i=0;i<divs.length;i++){			document.getElementById(divs[i]).style.display = "none";		}	}	function copyField(field_id, field_name, field_code){
		var obj = document.getElementById(fields[nowTable]+"_"+field_id);		if(obj && typeof(obj) != "undefined"){			$Dialog().alert("该字段已选择！");			return false;		}		var bodyObj = document.getElementById(tables[nowTable]+"Body");		var x = bodyObj.insertRow(-1);			x.setAttribute("dragFlag","true");		x.setAttribute("title",field_code);
		x.setAttribute("onclick","javascript:showProperty('"+field_id+"')");
				var c = x.insertCell(-1);		c.align = "center";		c.innerHTML = removeStr;				var h = htmlStrs[nowTable].replace(/\${alias}/g,field_name);		var c2 = x.insertCell(-1);		c2.align = "center";
		c2.innerHTML = h.replace(/\${field_id}/g,field_id);		var c3 = x.insertCell(-1);
		c3.align = "center";		c3.innerHTML = field_name;		var c4 = x.insertCell(-1);		c4.align = "center";		c4.innerHTML = detailStr.replace(/\${field_id}/g,field_id);	}	function showProperty(field_id){		for(var i=0;i<divs.length;i++){			if(i == nowTable){				document.getElementById(divs[i]).style.display = "";			}else{				document.getElementById(divs[i]).style.display = "none";			}		}		switch (tables[nowTable]) {		case "gridTable":			document.formGrid.reset();			document.formGrid.grid_field.value = field_id;			document.formGrid.grid_field_name.value = document.getElementById("grid_field_name_"+field_id).value;			setComboValue("grid_show_flag",document.getElementById("grid_show_flag_"+field_id).value,"formGrid");			setComboValue("grid_sort_order",document.getElementById("grid_sort_order_"+field_id).value,"formGrid");			document.formGrid.grid_format.value = document.getElementById("grid_format_"+field_id).value;			document.formGrid.grid_show_order_sigle.value = document.getElementById("grid_show_order_"+field_id).value;			setComboValue("grid_print_html",document.getElementById("grid_print_html_"+field_id).value,"formGrid");
			setComboValue("grid_compute_total",document.getElementById("grid_compute_total_"+field_id).value,"formGrid");			setComboValue("grid_show_align",document.getElementById("grid_show_align_"+field_id).value,"formGrid");
			break;		case "formTable":			document.formForm.reset();			document.formForm.form_field.value = field_id;			document.formForm.form_field_name.value = document.getElementById("form_field_name_"+field_id).value;			setComboValue("form_item_id",document.getElementById("form_item_id_"+field_id).value,"formForm");			setComboValue("form_show_type",document.getElementById("form_show_type_"+field_id).value,"formForm");			setComboValue("form_is_mandatory",document.getElementById("form_is_mandatory_"+field_id).value,"formForm");			setComboValue("form_is_readonly",document.getElementById("form_is_readonly_"+field_id).value,"formForm");			setComboValue("form_is_cascade_combo",document.getElementById("form_is_cascade_combo_"+field_id).value,"formForm");			document.formForm.form_width.value = document.getElementById("form_width_"+field_id).value;			document.formForm.form_colspan.value = document.getElementById("form_colspan_"+field_id).value;			document.formForm.form_rowspan.value = document.getElementById("form_rowspan_"+field_id).value;			document.formForm.form_show_order.value = document.getElementById("form_show_order_"+field_id).value;			document.formForm.form_show_color.value = document.getElementById("form_show_color_"+field_id).value;			break;		case "filterTable":			document.formFilter.reset();			document.formFilter.filter_field.value = field_id;			document.formFilter.filter_field_name.value = document.getElementById("filter_field_name_"+field_id).value;			setComboValue("filter_item_id",document.getElementById("filter_item_id_"+field_id).value,"formFilter");			setComboValue("filter_show_type",document.getElementById("filter_show_type_"+field_id).value,"formFilter");			setComboValue("filter_filter_type",document.getElementById("filter_filter_type_"+field_id).value,"formFilter");			setComboValue("filter_is_mandatory",document.getElementById("filter_is_mandatory_"+field_id).value,"formFilter");			document.formFilter.filter_width.value = document.getElementById("filter_width_"+field_id).value;			document.formFilter.filter_colspan.value = document.getElementById("filter_colspan_"+field_id).value;			document.formFilter.filter_rowspan.value = document.getElementById("filter_rowspan_"+field_id).value;			document.formFilter.filter_show_order.value = document.getElementById("filter_show_order_"+field_id).value;			break;		case "excelTable":			document.formExcel.reset();			document.formExcel.excel_field.value = field_id;			document.formExcel.excel_field_name.value = document.getElementById("excel_field_name_"+field_id).value;			setComboValue("excel_show_type",document.getElementById("excel_show_type_"+field_id).value,"formExcel");			document.formExcel.excel_show_order.value = document.getElementById("excel_show_order_"+field_id).value;			break;		case "pdfTable":			document.formPdf.reset();			document.formPdf.pdf_field.value = field_id;			document.formPdf.pdf_field_name.value = document.getElementById("pdf_field_name_"+field_id).value;			setComboValue("pdf_show_type",document.getElementById("pdf_show_type_"+field_id).value,"formPdf");			document.formPdf.pdf_show_order.value = document.getElementById("pdf_show_order_"+field_id).value;			break;		}	}	function setProperty(){		switch (tables[nowTable]) {
		case "gridTable":			var field_id = document.formGrid.grid_field.value;
			document.getElementById("grid_show_flag_"+field_id).value = document.formGrid.grid_show_flag.value;			document.getElementById("grid_sort_order_"+field_id).value = document.formGrid.grid_sort_order.value;			document.getElementById("grid_format_"+field_id).value = document.formGrid.grid_format.value;			document.getElementById("grid_show_order_"+field_id).value = document.formGrid.grid_show_order_sigle.value;			document.getElementById("grid_print_html_"+field_id).value = document.formGrid.grid_print_html.value;
			document.getElementById("grid_compute_total_"+field_id).value = document.formGrid.grid_compute_total.value;			document.getElementById("grid_show_align_"+field_id).value = document.formGrid.grid_show_align.value;
			break;		case "formTable":			var field_id = document.formForm.form_field.value;
			document.getElementById("form_item_id_"+field_id).value = document.formForm.form_item_id.value;			document.getElementById("form_show_type_"+field_id).value = document.formForm.form_show_type.value;			document.getElementById("form_is_mandatory_"+field_id).value = document.formForm.form_is_mandatory.value;			document.getElementById("form_is_readonly_"+field_id).value = document.formForm.form_is_readonly.value;			document.getElementById("form_is_cascade_combo_"+field_id).value = document.formForm.form_is_cascade_combo.value;			document.getElementById("form_width_"+field_id).value = document.formForm.form_width.value;			document.getElementById("form_colspan_"+field_id).value = document.formForm.form_colspan.value;			document.getElementById("form_rowspan_"+field_id).value = document.formForm.form_rowspan.value;			document.getElementById("form_show_order_"+field_id).value = document.formForm.form_show_order.value;			document.getElementById("form_show_color_"+field_id).value = document.formForm.form_show_color.value;
			break;		case "filterTable":			var field_id = document.formFilter.filter_field.value;			document.getElementById("filter_item_id_"+field_id).value = document.formFilter.filter_item_id.value;			document.getElementById("filter_show_type_"+field_id).value = document.formFilter.filter_show_type.value;			document.getElementById("filter_filter_type_"+field_id).value = document.formFilter.filter_filter_type.value;			document.getElementById("filter_is_mandatory_"+field_id).value = document.formFilter.filter_is_mandatory.value;			document.getElementById("filter_width_"+field_id).value = document.formFilter.filter_width.value;			document.getElementById("filter_colspan_"+field_id).value = document.formFilter.filter_colspan.value;			document.getElementById("filter_rowspan_"+field_id).value = document.formFilter.filter_rowspan.value;			document.getElementById("filter_show_order_"+field_id).value = document.formFilter.filter_show_order.value;			break;		case "excelTable":			var field_id = document.formExcel.excel_field.value;			document.getElementById("excel_show_type_"+field_id).value = document.formExcel.excel_show_type.value;			document.getElementById("excel_show_order_"+field_id).value = document.formExcel.excel_show_order.value;			break;		case "pdfTable":			var field_id = document.formPdf.pdf_field.value;			document.getElementById("pdf_show_type_"+field_id).value = document.formPdf.pdf_show_type.value;			document.getElementById("pdf_show_order_"+field_id).value = document.formPdf.pdf_show_order.value;			break;		}	}	function setFieldShowOrder(){		var showOrders = null;		switch (tables[nowTable]) {		case "gridTable":			showOrders = document.getElementsByName("grid_show_order");			if(showOrders){				for(var i=0;i<showOrders.length;i++){					showOrders[i].value = (i+1);				}			}			break;		case "formTable":			showOrders = document.getElementsByName("form_show_order");			if(showOrders){				var fields = document.formEditor.elements["form_field"];				var total = 1;				for(var i=0;i<fields.length;i++){										var field_col = document.getElementById("form_colspan_"+fields[i].value).value;					var field_show_type = document.getElementById("form_show_type_"+fields[i].value).value;					if(field_show_type == "9"){//hidden不占位						showOrders[i].value = "999";					}else{						showOrders[i].value = total;						var addNum = 1;						if(field_col != "" && !isNaN(field_col)){							addNum = Math.ceil(((parseInt(field_col)-1)/2))+1;						}						total += addNum;					}				}			}			break;		case "filterTable":			showOrders = document.getElementsByName("filter_show_order");			if(showOrders){				var fields = document.formEditor.elements["filter_field"];				var total = 1;				for(var i=0;i<fields.length;i++){					var field_col = document.getElementById("filter_colspan_"+fields[i].value).value;					var field_show_type = document.getElementById("filter_show_type_"+fields[i].value).value;					if(field_show_type == "9"){//hidden不占位						showOrders[i].value = "999";					}else{						showOrders[i].value = total;						var addNum = 1;						if(field_col != "" && !isNaN(field_col)){							addNum = Math.ceil(((parseInt(field_col)-1)/2))+1;						}						total += addNum;					}				}			}			break;		case "excelTable":			showOrders = document.getElementsByName("excel_show_order");			if(showOrders){				for(var i=0;i<showOrders.length;i++){					showOrders[i].value = (i+1);				}			}			break;		case "pdfTable":			showOrders = document.getElementsByName("pdf_show_order");			if(showOrders){				for(var i=0;i<showOrders.length;i++){					showOrders[i].value = (i+1);				}			}			break;		}	}	function hiddenEditDiv(){		document.getElementById(divs[nowTable]).style.display = "none";	}	function setFormFieldSkill(form_id,field_id)	{		WinOpen("${def:context}${def:actionroot}/fieldskill?form_id="+form_id+"&field_id="+field_id,13);	}			
	function FieldClass(){
		this.init = function(){
			//绑定事件   
		       var addEvent = document.addEventListener ? function(el,type,callback){   
		         el.addEventListener( type, callback, !1 );   
		       } : function(el,type,callback){   
		         el.attachEvent( "on" + type, callback );   
		       };   
		       //移除事件   
		       var removeEvent = document.removeEventListener ? function(el,type,callback){   
		         el.removeEventListener( type, callback );   
		       } : function(el,type,callback){   
		         el.detachEvent( "on" + type, callback);   
		       };   
		       //精确获取样式   
		       var getStyle = document.defaultView ? function(el,style){   
		         return document.defaultView.getComputedStyle(el, null).getPropertyValue(style);
		       } : function(el,style){   
		         style = style.replace(/\-(\w)/g, function($, $1){   
		           return $1.toUpperCase();   
		         });   
		         return el.currentStyle[style];   
		       };   
		       var dragManager = {   
		         clientY:0,   
		         draging:function(e){//mousemove时拖动行   
		           var dragObj = dragManager.dragObj;   
		           if(dragObj){   
		             e = e || event;   
		             if(window.getSelection){//w3c   
		               window.getSelection().removeAllRanges();   
		             }else  if(document.selection){   
		               document.selection.empty();//IE   
		             }   
		             var y = e.clientY;   
		             var down = y > dragManager.clientY;//是否向下移动   
		             var tr = document.elementFromPoint(e.clientX,e.clientY);
					 //限制了只有配置字段才能拖动
		             if(tr && tr.nodeName == "TD" && tr.parentNode.getAttribute("dragFlag")=="true"){   
		               tr = tr.parentNode;
		               dragManager.clientY = y;
		               if( dragObj !== tr){
		                 tr.parentNode.insertBefore(dragObj, (down ? tr.nextSibling : tr));
		               }
		             };
		           }
		         },
		         dragStart:function(e){   
		           e = e || event;   
		           var target = e.target || e.srcElement;   
		           if(target.nodeName === "TD"){   
		             target = target.parentNode;   
		             dragManager.dragObj = target;   
		             if(!target.getAttribute("data-background")){   
		               var background = getStyle(target,"background-color");   
		               target.setAttribute("data-background",background);
		             }   
		             //显示为可移动的状态   
		             target.style.backgroundColor = "#ccc";   
		             target.style.cursor = "move";   
		             dragManager.clientY = e.clientY;   
		             addEvent(document,"mousemove",dragManager.draging);   
		             addEvent(document,"mouseup",dragManager.dragEnd);   
		           }   
		         },   
		         dragEnd:function(){   
		           var dragObj = dragManager.dragObj;
		           if (dragObj) {   
		               //dragObj.style.backgroundColor = dragObj.getAttribute("data-background");   
		               dragObj.style.backgroundColor = "white";  
		               dragObj.style.cursor = "default";   
		               dragManager.dragObj = null;   
		               removeEvent(document,"mousemove",dragManager.draging);   
		               removeEvent(document,"mouseup",dragManager.dragEnd);   
					   //拖拽结束后排序
					   setFieldShowOrder();
		           }   
		         },   
		         main:function(el){   
		           addEvent(el,"mousedown",dragManager.dragStart);   
		         }   
		       };   
				for(var i=0;i<tables.length;i++){
					var el = document.getElementById(tables[i]);   
					dragManager.main(el);   
				}
		}
	}
	
	var fieldClass=null;
	$(document).ready(function() {
		//保存(发布表单)
		$("#publishBtn").on("click",function(){
			$Dialog().confirm("确定要发布吗？",function(){
				document.getElementById("publishBtn").disabled = true;
				var url = "${def:actionroot}/update";
				ajaxCall(url,{
						method: "post",
						progress: true,
						dataType: "script",
						form: "formEditor",
						success: function() {
							
						}
				});
			});
		});
		//权限配置按钮
		$(".btn_permissions").on("click",function(){
			$Dialog().open({url:"${def:context}${def:actionroot}/skill/form?form_id=${fld:form_id}",id:"skill",width:800,height:500});
		});
		//设置背景颜色的弹出框
		$("#form_show_color").colorpicker({
			fillcolor:true
		});
		
		
		fieldClass = new FieldClass();
		fieldClass.init();
	});</script>
</body>
</html>