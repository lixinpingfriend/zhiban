<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>员工管理</title>
</head>
<body>
	<div class="modal fade" id="modalAddnew1" tabindex="-1" role="dialog">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal"
						aria-hidden="true">&times;</button>
					<h4 class="modal-title" id="formTitle1">重置密码</h4>
				</div>
				<div class="modal-body">
					<form id="formEditor1" name="formEditor1" class="form-horizontal"
						role="form" method="post">
						<input type="hidden" name="tuid" value="" /> <input type="hidden"
							name="user_id" value="" /> <input type="hidden" name="userlogin"
							value="" />
						<div class="row clearfix">
							<div class="form-group">
								<label
									class="col-xs-2 col-sm-3 col-md-3 col-lg-3 control-label col-xs-offset-1 col-sm-offset-1 col-md-offset-1 col-lg-offset-1">用户名</label>
								<div class="col-xs-8 col-sm-7 col-md-7 col-lg-7" id="uName">

								</div>
							</div>
							<div class="form-group">
								<label
									class="col-xs-5 col-sm-3 col-md-3 col-lg-3 control-label col-xs-offset-1 col-sm-offset-1 col-md-offset-1 col-lg-offset-1">Email</label>
								<div class="col-xs-6 col-sm-7 col-md-7 col-lg-7" id="uEmail">

								</div>
							</div>
							<div class="form-group">
								<label
									class="col-xs-2 col-sm-3 col-md-3 col-lg-3 control-label col-xs-offset-1 col-sm-offset-1 col-md-offset-1 col-lg-offset-1 required">新密码</label>
								<div class="col-xs-8 col-sm-7 col-md-7 col-lg-7">
									<input id="passwd" name="passwd" class="form-control"
										type="password" size="20" maxlength="15" />
								</div>
							</div>
							<div class="form-group">
								<label
									class="col-xs-2 col-sm-3 col-md-3 col-lg-3 control-label col-xs-offset-1 col-sm-offset-1 col-md-offset-1 col-lg-offset-1 required">确认新密码</label>
								<div class="col-xs-8 col-sm-7 col-md-7 col-lg-7">
									<input id="confirm" name="confirm" class="form-control"
										type="password" size="20" maxlength="15" />
								</div>
							</div>
						</div>
					</form>
				</div>
				<div class="modal-footer">
					<div
						class="col-xs-12 col-sm-8 col-md-6 col-lg-8 col-xs-offset-1 col-sm-offset-2 col-md-offset-3 col-lg-offset-2">
						<button type="button" id="saveBtn" class="btn btn-primary btn-md">保&nbsp;存</button>
						<button type="button" class="btn btn-primary btn-md"
							data-dismiss="modal">取&nbsp;消</button>
					</div>
				</div>
			</div>
		</div>
	</div>

	<!--addnew/edit form-->
	<div class="modal fade" id="modalAddnew" tabindex="-1" role="dialog">
		<div class="modal-dialog modal-lg">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal"
						aria-hidden="true">&times;</button>
					<h4 class="modal-title" id="formTitle">新增员工</h4>
				</div>
				<div class="modal-body">
					<form id="formEditor" name="formEditor" class="form-horizontal"
						role="form" method="post">
						<input type="hidden" id="tuid" name="tuid" value="" /> <input
							type="hidden" name="org_id" id="org_id" value="" />
						<input type="hidden" id="del_user_id" name="del_user_id" value="" />

						<div class="row clearfix">
							<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
								<div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
									<div class="form-group">
										<label
											class="col-xs-5 col-sm-3 col-md-3 col-lg-4 control-label col-xs-offset-1 col-sm-offset-1 col-md-offset-1 col-lg-offset-1 required">登录代码</label>
										<div class="col-xs-6 col-sm-7 col-md-7 col-lg-7">
											<input id="userlogin" class="form-control" name="userlogin"
												type="text" size="20" maxlength="64" value="" /> <input
												id="user_id" name="user_id" type="hidden"
												class="form-control" size="20" value="" />
										</div>
									</div>
								</div>
								<div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 hidden-xs">
									<div class="form-group">
										<label
											class="col-xs-2 col-sm-3 col-md-3 col-lg-4 control-label col-xs-offset-1 col-sm-offset-1 col-md-offset-1 col-lg-offset-1">员工号码</label>
										<div class="col-xs-8 col-sm-7 col-md-7 col-lg-7">
											<input type="text" class="form-control" name="card_no"
												maxlength="16" value="" />
										</div>
									</div>
								</div>
							</div>
							<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
								<div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
									<div class="form-group" id="passwd_tr">
										<label
											class="col-xs-5 col-sm-3 col-md-3 col-lg-4 control-label col-xs-offset-1 col-sm-offset-1 col-md-offset-1 col-lg-offset-1 required">登录密码</label>
										<div class="col-xs-6 col-sm-7 col-md-7 col-lg-7">
											<input id="passwd" class="form-control" name="passwd"
												type="password" size="20" maxlength="15" />
										</div>
									</div>
								</div>
								<div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
									<div class="form-group">
										<label
											class="col-xs-2 col-sm-3 col-md-3 col-lg-4 control-label col-xs-offset-1 col-sm-offset-1 col-md-offset-1 col-lg-offset-1  required">人员分类</label>
										<div class="col-xs-8 col-sm-7 col-md-7 col-lg-7">
											<select id="staff_category" name="staff_category" class="form-control">
											    <option value=""></option>
											    <staff-list>
												<option value="${fld:domain_value}">${fld:domain_text_cn}</option></staff-list>
											</select>
										</div>
									</div>
								</div>
							</div>
							
							<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
								<div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
									<div class="form-group" id="confirm_tr">
										<label
											class="col-xs-5 col-sm-3 col-md-3 col-lg-4 control-label col-xs-offset-1 col-sm-offset-1 col-md-offset-1 col-lg-offset-1 required">确认密码</label>
										<div class="col-xs-6 col-sm-7 col-md-7 col-lg-7">
											<input id="confirm" class="form-control" name="confirm"
												type="password" size="20" maxlength="15" />
										</div>
									</div>
								</div>
								<div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
									  <div class="form-group" id="viplist" style="display: none;">
			 		 				      <label class="col-xs-2 col-sm-3 col-md-3 col-lg-4 control-label col-xs-offset-1 col-sm-offset-1 col-md-offset-1 col-lg-offset-1">所属会员</label>
			 		 				        <div class="col-xs-5 col-sm-4 col-md-4 col-lg-4">
			 		 					      <input id="vipname" name="vipname" class="form-control" value="" type="text" readonly=""/>
										      <input id="vipuserlogin" name="vipuserlogin" type="hidden" value=""/>
										      <input id="vip_name_2" name="vip_name_2" type="hidden" value=""/>
										      <input id="vip_userlogin_2" name="vip_userlogin_2" type="hidden" value=""/>
			 		 				       </div>
			 		 				       <div class="col-xs-3 col-sm-3 col-md-3 col-lg-3">
			 		 					     <img src="${def:context}/images/search.gif" class="tool" id="select_vip" title="查询"/>
										     <img src="${def:context}/images/clear.gif" id="pickClearn" class="tool2" title="清除选择的内容" />
			 		 				      </div>
	 		 			              </div> 
								</div>
							</div>
							<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 hidden-xs">
								<div class="form-group" id="pwd_policy_tr">
									<div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
										<label
											class="col-xs-2 col-sm-3 col-md-3 col-lg-4 control-label col-xs-offset-1 col-sm-offset-1 col-md-offset-1 col-lg-offset-1">密码安全策略</label>
										<div class="col-xs-8 col-sm-7 col-md-7 col-lg-7">
											<select name="pwd_policy" class="form-control">
												<option value="-2">系统默认安全策略</option>
												<option value="-1">密码永不过期</option>
												<option value="15">密码15天后过期</option>
												<option value="30">密码30天后过期</option>
												<option value="60">密码60天后过期</option>
												<option value="90">密码90天后过期</option>
											</select>
										</div>
									</div>
									<div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
										<input name="force_newpass" type="checkbox"
											class="form-control" value="1" /> 下次登录强制变更密码
									</div>
								</div>
							</div>
							
							
							<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
								<div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
									<div class="form-group">
										<label
											class="col-xs-5 col-sm-3 col-md-3 col-lg-4 control-label col-xs-offset-1 col-sm-offset-1 col-md-offset-1 col-lg-offset-1 required">员工技能</label>
										<div class="col-xs-6 col-sm-7 col-md-7 col-lg-7">
											<skill-list> <input id="skill_id"
												class="form-control" name="skill_id" type="checkbox"
												value="${fld:skill_id}" /> ${fld:skill_name} </skill-list>
										</div>
									</div>
									<div class="form-group">
										<label
											class="col-xs-5 col-sm-3 col-md-3 col-lg-4 control-label col-xs-offset-1 col-sm-offset-1 col-md-offset-1 col-lg-offset-1 required">
											姓名</label>
										<div class="col-xs-6 col-sm-7 col-md-7 col-lg-7">
											<input type="text" class="form-control" id="name" name="name"
												maxlength="100" value="" />
										</div>
									</div>
									<div class="form-group">
										<label
											class="col-xs-5 col-sm-3 col-md-3 col-lg-4 control-label col-xs-offset-1 col-sm-offset-1 col-md-offset-1 col-lg-offset-1 required">
											拼音缩写</label>
										<div class="col-xs-6 col-sm-7 col-md-7 col-lg-7">
											<input type="text" class="form-control" id="user_pinyin" name="user_pinyin"
												maxlength="100" value="" />
										</div>
									</div>
									<div class="form-group">
										<label
											class="col-xs-5 col-sm-3 col-md-3 col-lg-4 control-label col-xs-offset-1 col-sm-offset-1 col-md-offset-1 col-lg-offset-1 required">性别</label>
										<div class="col-xs-6 col-sm-7 col-md-7 col-lg-7">
											<input type="radio" id="sex" class="form-control" name="sex"
												checked="checked" value="0" />男 <input type="radio"
												id="sex" class="form-control" name="sex" value="1" />女
										</div>
									</div>
									<div class="form-group">
										<label
											class="col-xs-5 col-sm-3 col-md-3 col-lg-4 control-label col-xs-offset-1 col-sm-offset-1 col-md-offset-1 col-lg-offset-1">手机号码</label>
										<div class="col-xs-6 col-sm-7 col-md-7 col-lg-7">
											<input type="text" class="form-control" name="mobile"
												maxlength="30" value="" size="40" />
										</div>
									</div>
									<div class="form-group">
										<label
											class="col-xs-5 col-sm-3 col-md-3 col-lg-4 control-label col-xs-offset-1 col-sm-offset-1 col-md-offset-1 col-lg-offset-1">入职日期</label>
										<div class="col-xs-6 col-sm-7 col-md-7 col-lg-7">
											<input id="entry_date" class="form-control" name="entry_date"
												type="text" value="" />
										</div>
									</div>
									<div class="form-group">
										<label
											class="col-xs-5 col-sm-3 col-md-3 col-lg-4 control-label col-xs-offset-1 col-sm-offset-1 col-md-offset-1 col-lg-offset-1">Email</label>
										<div class="col-xs-6 col-sm-7 col-md-7 col-lg-7">
											<input type="text" id="email" class="form-control"
												name="email" maxlength="100" value="" size="40" />
										</div>
									</div>
									<div class="form-group">
										<label
											class="col-xs-5 col-sm-3 col-md-3 col-lg-4 control-label col-xs-offset-1 col-sm-offset-1 col-md-offset-1 col-lg-offset-1">备注</label>
										<div class="col-xs-6 col-sm-7 col-md-7 col-lg-7">
											<textarea name="remark" class="form-control" cols="30"
												rows="2" maxlength="256"></textarea>
										</div>
									</div>
								</div>
								<div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
									<div class="form-group hidden-xs">
										<label
											class="col-xs-2 col-sm-3 col-md-3 col-lg-4 control-label col-xs-offset-1 col-sm-offset-1 col-md-offset-1 col-lg-offset-1">默认语言</label>
										<div class="col-xs-8 col-sm-7 col-md-7 col-lg-7">
											<select id="locale" name="locale" class="form-control">
												<option value="cn">中文</option>
												<option value="en">English</option>
											</select>
										</div>
									</div>
									<div class="form-group hidden-xs">
										<label
											class="col-xs-2 col-sm-3 col-md-3 col-lg-4 control-label col-xs-offset-1 col-sm-offset-1 col-md-offset-1 col-lg-offset-1">hourly
											rate</label>
										<div class="col-xs-8 col-sm-7 col-md-7 col-lg-7">
											<input type="text" class="form-control" name="hourly_rate"
												id="hourly_rate" maxlength="16" value="" />
										</div>
									</div>
									<div class="form-group hidden-xs">
										<label
											class="col-xs-5 col-sm-3 col-md-3 col-lg-4 control-label col-xs-offset-1 col-sm-offset-1 col-md-offset-1 col-lg-offset-1">出生日期</label>
										<div class="col-xs-6 col-sm-7 col-md-7 col-lg-7">
											<input id="birthday" class="form-control" name="birthday"
												type="text" value="" />
										</div>
									</div>

									<div class="form-group hidden-xs">
										<label
											class="col-xs-2 col-sm-3 col-md-3 col-lg-4 control-label col-xs-offset-1 col-sm-offset-1 col-md-offset-1 col-lg-offset-1">合同起始日期</label>
										<div class="col-xs-8 col-sm-7 col-md-7 col-lg-7">
											<input id="contract_from" class="form-control"
												name="contract_from" type="text" value="" />
										</div>
									</div>
									<div class="form-group hidden-xs">
										<label
											class="col-xs-2 col-sm-3 col-md-3 col-lg-4 control-label col-xs-offset-1 col-sm-offset-1 col-md-offset-1 col-lg-offset-1">合同终止日期</label>
										<div class="col-xs-8 col-sm-7 col-md-7 col-lg-7">
											<input id="contract_end" class="form-control"
												name="contract_end" type="text" value="" />
										</div>
									</div>
									<div class="form-group hidden-xs">
										<label
											class="col-xs-2 col-sm-3 col-md-3 col-lg-4 control-label col-xs-offset-1 col-sm-offset-1 col-md-offset-1 col-lg-offset-1">通讯地址</label>
										<div class="col-xs-8 col-sm-7 col-md-7 col-lg-7">
											<textarea name="address" cols="30" class="form-control"
												rows="2" maxlength="256"></textarea>
										</div>
									</div>

								</div>
							</div>
						</div>
					</form>
				</div>
				<div class="modal-footer">
					<div
						class="col-xs-12 col-sm-8 col-md-6 col-lg-8 col-xs-offset-1 col-sm-offset-2 col-md-offset-3 col-lg-offset-2">
						<button type="button" id="save_btn" class="btn btn-primary btn-md">保&nbsp;存</button>
						<button class="btn btn-primary btn-md delete_btn" type="button" >删&nbsp;除</button>
						<button type="button" class="btn btn-primary btn-md"
							data-dismiss="modal">取&nbsp;消</button>
					</div>
				</div>
			</div>
		</div>
	</div>

	<!--filter form-->
	<!--grid view response-->
	<div class="panel panel-default col_mainInner">
		<div class="panel-heading col_main_body_title text-center">
			<h2 class="panel-title">查询员工信息</h2>
		</div>
		<div class="panel-body col_main_body">
			<form class="form-horizontal" role="form" method="post"
				id="searchForm">
				<input name="sort" type="hidden" value="userlogin" preserve="true" />
				<input type="hidden" name="org_id" value="${fld:org_id}"
					preserve="true" /> <input name="order" type="hidden" value="desc"
					preserve="true" /> <input name="pageNo" type="hidden" value=""
					preserve="true" /> <input name="totalPages" type="hidden" value=""
					preserve="true" />
				<div class="form-group">
					<div class="col-xs-5 col-sm-3 col-md-3 col-lg-3">
						<input name="name" type="text" class="form-control" size="20"
							value="" placeholder="请输入 姓名或拼音缩写或登录号" />
					</div>
					<div class="col-xs-3 col-sm-3 col-md-3 col-lg-3 hidden-xs">
						<label class="col-xs-2 col-sm-3 col-md-3 col-lg-3 control-label">状态</label>
						<input name="enabled" type="radio" size="35" value="1" />正常 <input
							name="enabled" type="radio" size="35" value="0" />禁用
					</div>
					<div class="col-xs-6 col-sm-4 col-md-4 col-lg-4 text-left">
						<div
							class="col-xs-3 col-sm-2 col-md-2 col-lg-2 col-xs-offset-1 col-sm-offset-1 col-md-offset-1 col-lg-offset-1">
							<button class="btn btn-primary btn-md" type="button"
								id="search_btn">查询</button>
						</div>
						<div
							class="col-xs-3 col-sm-2 col-md-2 col-lg-2 col-xs-offset-1 col-sm-offset-1 col-md-offset-1 col-lg-offset-1">
							<button class="btn btn-primary btn-md" type="button"
								id="search_reset_btn">清空</button>
						</div>
						<div
							class="col-xs-3 col-sm-2 col-md-2 col-lg-2 col-xs-offset-1 col-sm-offset-1 col-md-offset-1 col-lg-offset-1">
							<button class="btn btn-primary btn-md" type="button"
								data-toggle="modal" id="addnew_btn">新增</button>
						</div>
					</div>
				</div>
			</form>
			<table class="table table-bordered">
				<thead>
					<tr>
						<th>操作</th>
						<th class="sortable" code="userlogin">登录名</th>
						<th class="sortable hidden-xs" code="alias">别名</th>
						<th class="sortable" code="name">姓名</th>
						<th class="sortable hidden-xs" code="user_pinyin">拼音缩写</th>
						<th class="sortable hidden-xs" code="sex">性别</th>
						<th class="sortable hidden-xs" code="mobile">手机号码</th>
						<th class="sortable hidden-xs" code="org_name">部门名称</th>
						<th class="sortable hidden-xs" code="state">状态</th>
					</tr>
				</thead>
				<tbody id="datagridTemplate" style="display: none">
					<tr>
						<td align="center">
							<button class="btn btn-primary btn-md edit_btn" type="button"
								code="#userlogin#">编辑</button>
							<button class="btn btn-primary btn-md resetPW_btn" type="button"
								code="#user_id#">重置密码</button> #button#
							<button class="btn btn-primary btn-md transferPost_btn hidden-xs" type="button"
								code="#user_id#">转岗</button>
						</td>
						<td align="center">#userlogin#</td>
						<td align="center" class="hidden-xs">#alias#</td>
						<td align="center">#name#</td>
						<td align="center" class="hidden-xs">#user_pinyin#</td>
						<td align="center" class="hidden-xs">#sex#</td>
						<td align="center" class="hidden-xs">#mobile#</td>
						<td align="center" class="hidden-xs">#org_name#</td>
						<td align="center" class="hidden-xs">#state#</td>
					</tr>
				</tbody>
				<tbody id="datagrid"></tbody>
			</table>
			<div class="pageDiv">
				<ul class="pagination">
				</ul>
			</div>
		</div>
	</div>
	<!--用于传递当前目录到header模版中-->
	<input type="hidden" name="actionroot" id="actionroot" value="${def:actionroot}" />
<script type="text/javascript">
function StaffClass(){
	this.init = function(){
		var searchObj=null;
		var obj = $Crud({
			formId:"formEditor",
			button:"save_btn",
			insertBack:function(){
				searchObj.searchData(1);
			},
			updateBack:function(){
				searchObj.searchData(1);
			},
			deleteBack:function(){
				searchObj.searchData(1);
			},
			addNewBack:function(){
				$("#formTitle").html("新增员工信息");
				$("#org_id").val("${fld:org_id}");
				$("#passwd_tr").show();
				$("#confirm_tr").show();
				$("#pwd_policy_tr").show();
				$(".delete_btn").hide();
				document.formEditor.userlogin.disabled=false;
				document.getElementById("viplist").style.display = "none";
				document.getElementById("vipname").value='';
				document.getElementById("vipuserlogin").value='';
			},
			editBack:function(){
				$("#formTitle").html("修改员工信息");
				$(".delete_btn").show();
			},
			validate:function(){
				var flag=$("#formEditor").validate({
					rules: {
						userlogin: {
							required: true,
							rangelength: [1,64]
						},
						skill_id: {
							required: true,
						},
						
						passwd: {
							required: true,
							rangelength: [1,15]
						},
						confirm: {
							required: true,
							rangelength: [1,15]
						},
						name: {
							required: true,
							rangelength: [1,25]
						},
						sex: {
							required: true
						}
					},
					messages: {
						userlogin: {
							required: "请输入登录代码",
							rangelength: "登录代码长度为1到64位"
						},
						skill_id: {
							required: "请选择员工技能"
						},
						
						passwd: {
							required: "请输入登录密码",
							rangelength: "登录密码长度为1到15位"
						},
						confirm: {
							required: "请输入确认密码",
							rangelength: "确认密码长度为1到15位"
						},
						name: {
							required: "请输入名称",
							rangelength: "名称长度为1到25位"
						},
						sex: {
							required: "请选择性别"
						}
					}
				});
				return flag;
			},
			check:function(){
				document.formEditor.userlogin.disabled=false;
				return true;
			}
		}).init();
		
		searchObj=$Search({datagrid:"datagrid",formId:"searchForm",rowpackage:function(obj){
			if(obj.state=="正常"){
				obj.button="<button class='btn btn-primary btn-md disable_btn' type='button' code='"+obj.user_id+"'>禁用</button>";
			}else{
				obj.button="<button class='btn btn-primary btn-md enable_btn' type='button' code='"+obj.user_id+"'>启用</button>";
			}
		},success:function(){
			$(".edit_btn").on("click", function(){
				if($(this).attr("code") != undefined && $(this).attr("code") != ""){
					obj.edit({id:$(this).attr("code")});
				}
			});
			$(".delete_btn").unbind(); 
			$(".delete_btn").on("click", function(){
				$Dialog().confirm("确定要删除吗?", function(){
					$("#modalAddnew").modal("hide");
					if($("#del_user_id").val() != undefined && $("#del_user_id").val() != ""){
						obj.del({id:$("#del_user_id").val()});
					}
				});
			});
			$(".disable_btn").on("click",function(){
				var obthis = $(this);
				$Dialog().confirm("确定要禁用此用户吗?", function(){
					if(obthis.attr("code") != undefined && obthis.attr("code") != ""){
						var url = "${def:actionroot}/disable?id=" + obthis.attr("code");
						ajaxCall(url,{
							method: "get",
							progress: true,
							dataType: "script",
							success: function(){
								searchObj.searchData(1);
							}
						});
					}
				});
			});
			$(".enable_btn").on("click",function(){
				var obthis = $(this);
				$Dialog().confirm("确定要启用此用户吗?", function(){
					if(obthis.attr("code") != undefined && obthis.attr("code") != ""){
						var url = "${def:actionroot}/enable?id=" + obthis.attr("code");
						ajaxCall(url,{
							method: "get",
							progress: true,
							dataType: "script",
							success: function(){
								searchObj.searchData(1);
							}
						});
					}
				});
			});
			$(".resetPW_btn").on("click",function(){
				if($(this).attr("code") != undefined && $(this).attr("code") != ""){
					var url = "${def:context}${def:actionroot}/newpass/form?user_id="+$(this).attr("code");
					ajaxCall(url,{
							method: "get",
							progress: true,
							dataType: "script",
							success: function() {
								$("#modalAddnew1").modal("show");
							}
					});
				}
			});
			//转岗
			$(".transferPost_btn").on("click",function(){
				if($(this).attr("code") != undefined && $(this).attr("code") != ""){
					var url = "${def:context}/action/ccms/module/hr/staff/transferPost/crud?tuid="+$(this).attr("code");
				}
				$Dialog().open({url:url,id:"transferPost",width:500,height:400});
			});
			//根据人员类型显示所属会员
			$("#staff_category").unbind();
			$("#staff_category").on("change",function(){
				if("2"==$("#staff_category").val()){
					document.getElementById("viplist").style.display = "";
					document.getElementById("vipname").value=document.getElementById("vip_name_2").value;
					document.getElementById("vipuserlogin").value=document.getElementById("vip_userlogin_2").value;
					}else{
						document.getElementById("viplist").style.display = "none";
						document.getElementById("vipname").value='';
						document.getElementById("vipuserlogin").value='';
						}
			});
			//所属会员
			$("#select_vip").unbind();
			$("#select_vip").on("click",function(){
				var url = "${def:context}/action/ccms/module/hr/staff/select_user/crud?id=vipuserlogin&name=vipname&pickId=dialogPic";
				$Dialog().open({url:url,id:"dialogPic",width:600,height:500});
			});
			$("#pickClearn").on("click",function(){
				document.formEditor.vipuserlogin.value = '';
				document.formEditor.vipname.value = '';
			});
		}}).initSearchBtn().searchData(1);
		
		$("#saveBtn").on("click",function(){
			var url = "${def:actionroot}/newpass/update";
			ajaxCall(url,{
					method: "post",
					progress: true,
					form: "formEditor1",
					button: "saveBtn",
					dataType: "script",
					success: function() {
						$Dialog().alert("修改成功！");
						$("#modalAddnew1").modal("hide");
					}
			});
			
		});
		
		$Dialog().date($('#birthday'));
		$Dialog().date($('#entry_date'));
		$Dialog().date($('#contract_end'));
		$Dialog().date($('#trial_end'));
		$Dialog().date($('#contract_from'));
		$Dialog().date($('#dispatch_date'));
		$Dialog().date($('#dispatch_date'));
	}
}

var staffClass=null;
$(document).ready(function() {
	staffClass = new StaffClass();
	staffClass.init();
});
</script>
</body>
</html>